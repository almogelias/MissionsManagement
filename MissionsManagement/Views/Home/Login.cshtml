

<title>@ViewBag.Title</title>

<link rel="stylesheet" href="~/Content/Login.css">
<div>

    <div class="container_form">
        <h1>Login</h1>
        <p>Please fill in this form to login</p>
        <hr>
        <div class="section">
            <label for="username"><b>Username</b></label>
            <input type="text" placeholder="Enter Email" name="username" id="username" required>
        </div>
        <div class="section">
            <label for="psw"><b>Password</b></label>
            <input type="password" placeholder="Enter Password" name="psw" id="psw" required>
        </div>
        <hr>

            <button type="submit" id="loginbtn">Login</button>
        </div>

    <div class="container login">
        <p>Don't have an account? <a href="@Url.Action("Register", "Home")">Sign in</a>.</p>
    </div>
</div>
<script src="~/Scripts/jquery-3.6.0.min.js"></script>

<script type="text/javascript">

        $(document).ready(function () {
            //click button to use the login api call from identity in Controller API
            $('#loginbtn').click(function () {
                $.ajax({
                    url: '/token',
                    method: 'POST',
                    contentType: 'application/json',
                    data:
                    {
                        username: $('#username').val(),
                        password: $('#psw').val(),
                        grant_type: 'password'
                    },
                    success: function (response) {
                        sessionStorage.setItem('accessToken', response.access_token)
                        //sessionStorage.setItem('accessToken') - for geting an item
                        //sessionStorage.removeItem('accessToken') - for removing an item
                        alert('User logged in!')
                        window.location.href='@HttpContext.Current.Request.Url.GetLeftPart(UriPartial.Authority)'

                    },
                    error: function (jqXHR) {
                        console.log(jqXHR.responseText)
                    }
                })
            })
        })
</script>



